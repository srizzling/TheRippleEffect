var map;var styles;var townLabels=false;var regions=[];var riverLayer;var lakeLayer;var regionFillCol="#FFFFFF";var regionStrokeCol="#2B547E";var regionFillColShow="#2B547E";var regionStrokeColShow="#2B547E";var regionFillOpacity=0.05;var regionFillOpacityShow=0;var regionFillOpacityMouse=0.32;var regionStrokeWeight=1;var regionStrokeWeightShow=3.1;google.maps.visualRefresh=true;function loadLayers(){riverLayer=new google.maps.FusionTablesLayer({map:map,heatmap:{enabled:false},query:{select:"col4",from:"1Cb9of1mmMn9YLrIFUlQe0wnOMZg-0zqQTRRJHT0",where:""},options:{styleId:2,templateId:2}});lakeLayer=new google.maps.FusionTablesLayer({map:map,heatmap:{enabled:false},query:{select:"col10",from:"1_sDMfg9NEPd9WiwUe4OIxCSfO_A7Nr1p-TjTpUM",where:""},options:{styleId:2,templateId:2}});riverLayer.setMap(null);lakeLayer.setMap(null)}function displayRivers(){if(riverLayer.getMap()==null&&lakeLayer.getMap()==null){riverLayer.setMap(map);lakeLayer.setMap(map)}else{riverLayer.setMap(null);lakeLayer.setMap(null)}}function createInfoWindow(f,e,c,b,a){var d='<style> #content{word-wrap: break-word; max-width:400px;}#image {height:300px; width:400px; }#image img{max-width:100%; max-height:100%; margin:auto; display:block; -ms-interpolation-mode: bicubic}</style><div id="content"><div id="siteNotice"></div><h2 id="firstHeading" class="firstHeading"> '+e+'</h2><div id = "image"><a href="'+f+'" target="_blank" ><img src="'+f+'" /></img></a></div><div id="bodyContent"><p><b>Description:</b> '+c+"</p><p><b>Uploaded:</b> "+b+"</p><p><b>Tags:</b> "+a+"</p></div></div>";info=new google.maps.InfoWindow({content:d});return info}function createMarkers(a,f,e){var c=false;if(f==null){f="brown-drop.png"}for(var d=0;d<regions.length;d++){if(c==true){break}if(google.maps.geometry.poly.containsLocation(a,regions[d].polygon)){var b=new google.maps.Marker({position:a,map:this.map,icon:f});b.info=e;b.setVisible(false);b.setMap(map);regions[d].markers.push(b);c=true}}}function toggleRegionMarkers(c){for(var b=0;b<c.markers.length;b++){if(c.markers[b].getVisible()==true){var a=c.markers[b];a.setVisible(false);a.info.close();c.text.setMap(map);c.markers[b]=a}else{c.text.setMap(null);a=c.markers[b];a.setVisible(true);c.markers[b]=a}}}function addMarkerListener(a){google.maps.event.addListener(a,"click",function(){for(var c=0;c<regions.length;c++){for(var b=0;b<regions[c].markers.length;b++){if(regions[c].markers[b]!=a){regions[c].markers[b].info.close()}}}if(a.info.getMap()==null){a.info.open(map,a)}else{a.info.close()}})}function region(a,b){this.polygon=b;this.name=a;this.markers=[];this.selected=false;this.center=null;this.text=null}function constructPolygon(d,a){var b=new region(a,new google.maps.Polygon({paths:d,strokeColor:regionStrokeCol,strokeOpacity:0.8,strokeWeight:regionStrokeWeight,fillColor:regionFillCol,fillOpacity:regionFillOpacity}));var c=new google.maps.LatLngBounds();for(i=0;i<d.length;i++){c.extend(d[i])}b.polygon.setMap(map);b.center=c.getCenter();regions.push(b)}function AddEventHandlers(a){google.maps.event.addListener(a.polygon,"click",function(){regionSelector(a.polygon);toggleRegionMarkers(a)});google.maps.event.addListener(a.polygon,"mouseover",function(){if(a.polygon.get("fillOpacity")==regionFillOpacity){a.polygon.setOptions({fillOpacity:regionFillOpacityMouse})}});google.maps.event.addListener(a.polygon,"mouseout",function(){if(a.polygon.get("fillOpacity")==regionFillOpacityMouse){a.polygon.setOptions({fillOpacity:regionFillOpacity})}})}function regionSelector(a){if(a==null){DeselectRegions();var d=document.getElementById("region").value;if(d=="All"){for(var c=0;c<regions.length;c++){regions[c].text.setMap(null);regions[c].polygon.setOptions({fillColor:regionFillColShow,fillOpacity:regionFillOpacityShow,strokeColor:regionStrokeColShow,strokeWeight:regionStrokeWeightShow});for(var b=0;b<regions[c].markers.length;b++){regions[c].markers[b].setVisible(true)}}}else{for(var c=0;c<regions.length;c++){if(d==regions[c].name){regions[c].text.setMap(null);regions[c].polygon.setOptions({fillColor:regionFillColShow,fillOpacity:regionFillOpacityShow,strokeColor:regionStrokeColShow,strokeWeight:regionStrokeWeightShow});toggleRegionMarkers(regions[c]);break}}}}else{if(a.get("fillOpacity")==regionFillOpacityShow){a.setOptions({fillOpacity:regionFillOpacity,fillColor:regionFillCol,strokeColor:regionStrokeCol,strokeWeight:regionStrokeWeight})}else{a.setOptions({fillColor:regionFillColShow,fillOpacity:regionFillOpacityShow,strokeColor:regionStrokeColShow,strokeWeight:regionStrokeWeightShow})}}}function DeselectRegions(){for(var b=0;b<regions.length;b++){regions[b].text.setMap(map);regions[b].polygon.setOptions({fillColor:regionFillCol,fillOpacity:regionFillOpacity,strokeColor:regionStrokeCol,strokeWeight:regionStrokeWeight});regions[b].text.setMap(map);for(var a=0;a<regions[b].markers.length;a++){regions[b].markers[a].setVisible(false);regions[b].markers[a].info.close()}}}function initialize(){var g=document.getElementById("map_canvas");var d={center:new google.maps.LatLng(-41,172),zoom:6,mapTypeId:google.maps.MapTypeId.TERRAIN,panControl:false,streetViewControl:false,scaleControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.DROPDOWN_MENU},disableDoubleClickZoom:true,zoomControlOptions:{style:google.maps.ZoomControlStyle.DEFAULT,position:google.maps.ControlPosition.RIGHT_CENTER}};map=new google.maps.Map(g,d);google.maps.event.addListener(map,"zoom_changed",function(){if(map.getZoom()<6){map.setZoom(6)}});styles=[{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#99b3cc"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#FF0000"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#FFFFFF"},{weight:25}]},{featureType:"landscape",elementType:"geometry.fill",stylers:[{color:"#c7d9a7"}]},{featureType:"administrative.province",elementType:"all",stylers:[{visibility:"off"}]}];map.setOptions({styles:styles});google.maps.event.addListener(map,"maptypeid_changed",function(){if(map.getMapTypeId()=="satellite"||map.getMapTypeId()=="hybrid"){regionStrokeCol="#FFFFFF";regionStrokeColShow="#FFFFFF"}else{if(map.getMapTypeId()=="terrain"){regionStrokeCol="#2B547E";regionStrokeColShow="#2B547E"}else{if(map.getMapTypeId()=="roadmap"){regionStrokeCol="#2B547E";regionStrokeColShow="#2B547E"}}}DeselectRegions()});constructPolygon(loadNorthland(),"Northland");constructPolygon(loadAuckland(),"Auckland");constructPolygon(loadWaikato(),"Waikato");constructPolygon(loadWestcoast(),"West Coast");constructPolygon(loadBayofplenty(),"Bay of Plenty");constructPolygon(loadCanterbury(),"Canterbury");constructPolygon(loadGisborne(),"Gisborne");constructPolygon(loadOtago(),"Otago");constructPolygon(loadSouthland(),"Southland");constructPolygon(loadHawkesbay(),"Hawke's Bay");constructPolygon(loadTasman(),"Tasman");constructPolygon(loadTaranaki(),"Taranaki");constructPolygon(loadManawatu(),"Manawatu-Wanganui");constructPolygon(loadNelson(),"Nelson");constructPolygon(loadWellington(),"Wellington");constructPolygon(loadMarlborough(),"Marlborough");for(var e=0;e<regions.length;e++){AddEventHandlers(regions[e])}var f=[{extension:"jpg",image_name:"Cows and a pig in the Kaeo River",lat:"-35.0898333333",path:"//www.wainz.org.nz/static/uploaded-images/243695398329515817226931691155125491443",lng:"173.7676666667",id:74,icon:"brown-drop.png"},{extension:"jpg",image_name:"North Canterbury beef stock in stream",lat:"-42.6307673469",path:"//www.wainz.org.nz/static/uploaded-images/89914717573047748667166252363738837018",lng:"173.1396888950",id:31,icon:"brown-drop.png"},{extension:"jpg",image_name:"Ihumatao - Oruarangi creek",lat:"-36.9798380399",path:"//www.wainz.org.nz/static/uploaded-images/40077846748125228723856284165115698322",lng:"174.7628266609",id:75,icon:"brown-drop.png"},{extension:"jpg",image_name:"Stock in river",lat:"-36.6313454500",path:"//www.wainz.org.nz/static/uploaded-images/267333552515848401917699247648915644642",lng:"175.4745340347",id:65,icon:"brown-drop.png"},{extension:"jpg",image_name:"Cows in river",lat:"-41.2834905869",path:"//www.wainz.org.nz/static/uploaded-images/4234521036228318747925117750426449282",lng:"175.6608375907",id:66,icon:"brown-drop.png"},{extension:"jpg",image_name:"Just north of Carterton",lat:"-41.0221930018",path:"//www.wainz.org.nz/static/uploaded-images/85374843667129068625713784148686059742",lng:"175.5607570540",id:76,icon:"brown-drop.png"},{extension:"jpg",image_name:"Mangaokewa, Te Kuiti",lat:"-38.3341631737",path:"//www.wainz.org.nz/static/uploaded-images/198323447572416469987830335439486251667",lng:"175.1677943993",id:69,icon:"blue-drop.png"},{extension:"JPG",image_name:"Manawatu River",lat:"-41.2900997149",path:"//www.wainz.org.nz/static/uploaded-images/245743661757911788429686004627085415186",lng:"174.7681526604",id:77,icon:"brown-drop.png"},{extension:"jpg",image_name:"Cherry island taupo",lat:"-38.6773182435",path:"//www.wainz.org.nz/static/uploaded-images/279789384298890445560306479313046407886",lng:"176.0830097757",id:71,icon:"blue-drop.png"},{extension:"jpg",image_name:"Otahu river whangamata",lat:"-37.2353333333",path:"//www.wainz.org.nz/static/uploaded-images/309131387348949667208182903313572842483",lng:"175.8441666667",id:72,icon:"blue-drop.png"},{extension:"jpg",image_name:"Beef cows in the Kaeo river Northland",lat:"-35.0953389418",path:"//www.wainz.org.nz/static/uploaded-images/241367489107703108199158756949244494487",lng:"173.7731507560",id:73,icon:"brown-drop.png"},{extension:"jpg",image_name:"feedlot",lat:"-39.9602803543",path:"//www.wainz.org.nz/static/uploaded-images/312318377253163054147030580165596946856",lng:"176.6546630859",id:104,icon:"brown-drop.png"},{extension:"jpg",image_name:"Kakapotahi river oil spill",lat:"-43.0071286908",path:"//www.wainz.org.nz/static/uploaded-images/86459809820991683833063977168781532255",lng:"170.7435547964",id:101,icon:"brown-drop.png"},{extension:"JPG",image_name:"Kawhatau River",lat:"-41.2900997149",path:"//www.wainz.org.nz/static/uploaded-images/309229793600700305913124669277978193640",lng:"174.7681526604",id:100,icon:"brown-drop.png"},{extension:"jpg",image_name:"Clean river above farms runoff",lat:"-37.2660000000",path:"//www.wainz.org.nz/static/uploaded-images/87522579744651000013162890152487273256",lng:"175.8345000000",id:85,icon:"blue-drop.png"},{extension:"JPG",image_name:"SH53",lat:"-41.2900997149",path:"//www.wainz.org.nz/static/uploaded-images/49829753665157234762976905096478417552",lng:"174.7681526604",id:87,icon:"blue-drop.png"},{extension:"JPG",image_name:"Tuakau, North Waikato",lat:"-41.2900997149",path:"//www.wainz.org.nz/static/uploaded-images/163257200272820323333514426063617433536",lng:"174.7681526604",id:117,icon:"blue-drop.png"},{extension:"jpg",image_name:"feedlot on river",lat:"-39.9434364620",path:"//www.wainz.org.nz/static/uploaded-images/12134325451602530810715733871881281727",lng:"176.6546630859",id:105,icon:"brown-drop.png"},{extension:"jpg",image_name:"OLD Waipawa river bed",lat:"-39.9771200984",path:"//www.wainz.org.nz/static/uploaded-images/18397363273428760096505715131402403585",lng:"176.5118408203",id:106,icon:"brown-drop.png"},{extension:"jpg",image_name:"",lat:"-41.3228252727",path:"//www.wainz.org.nz/static/uploaded-images/242468383331370402552151624510231644065",lng:"173.1582760348",id:108,icon:"blue-drop.png"},{extension:"jpg",image_name:"Whau Estuary Pollution",lat:"-36.8631414330",path:"//www.wainz.org.nz/static/uploaded-images/74298425246354173290188832744210528168",lng:"174.6560096741",id:120,icon:"brown-drop.png"},{extension:"jpg",image_name:"Aratitia rapids",lat:"-38.6159379939",path:"//www.wainz.org.nz/static/uploaded-images/79616475897059200773379118519225608853",lng:"176.1414284965",id:119,icon:"blue-drop.png"},{extension:"jpg",image_name:"Wainui Stream, Paekakariki",lat:"-40.9766171339",path:"//www.wainz.org.nz/static/uploaded-images/204609434489357963808645843905837819961",lng:"174.9658466019",id:121,icon:"brown-drop.png"},{extension:"jpg",image_name:"Foam Pollution",lat:"-36.9014157136",path:"//www.wainz.org.nz/static/uploaded-images/285707902342278628524736369292301415102",lng:"174.6849185228",id:122,icon:"brown-drop.png"},{extension:"jpg",image_name:"Avon River Christchurch ",lat:"-43.5088333333",path:"//www.wainz.org.nz/static/uploaded-images/216635625063130034243286474750037167002",lng:"172.7206666667",id:141,icon:"blue-drop.png"},{extension:"jpg",image_name:"Urban Stormwater pollution",lat:"-36.7691170095",path:"//www.wainz.org.nz/static/uploaded-images/293044740516495894773979580551735086415",lng:"174.7408054897",id:144,icon:"brown-drop.png"},{extension:"jpg",image_name:"Whakamaru2013-2",lat:"-38.4108272709",path:"//www.wainz.org.nz/static/uploaded-images/257707619820531229678247493517074568808",lng:"175.8097457886",id:125,icon:"brown-drop.png"}];for(var e=0;e<f.length;e++){createMarkers(new google.maps.LatLng(f[e].lat,f[e].lng),f[e].icon,createInfoWindow("http:"+f[e].path+"."+f[e].extension+"",f[e].image_name,"No description is currently available","??/??/??","No tags are currently available"))}createMarkers(new google.maps.LatLng(-44.1697692409,170.971351862),null,createInfoWindow("dead-cow.jpg","Opihi River","A deceased cow in the Opihi river","12/09/13","cow, river"));for(var e=0;e<regions.length;e++){if(regions[e].name=="Wellington"){var a={text:regions[e].markers.length-3,position:regions[e].center,map:map,fontSize:20,fontColor:"white",strokeColor:regionStrokeCol,fillOpacity:1,strokeOpacity:1}}else{var a={text:regions[e].markers.length,position:regions[e].center,map:map,fontColor:"white",strokeColor:regionStrokeCol,fontSize:20}}var c=new MapLabel(a);regions[e].text=c}for(var e=0;e<regions.length;e++){for(var b=0;b<regions[e].markers.length;b++){addMarkerListener(regions[e].markers[b])}}loadLayers()}google.maps.event.addDomListener(window,"load",initialize);